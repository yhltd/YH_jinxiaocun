<!-- 日期时间选择器组件 -->
<tui-datetime 
  id="tui-dateTime-ctx" 
  type="{{type}}" 
  startYear="{{startYear}}" 
  endYear="{{endYear}}" 
  cancelColor="{{cancelColor}}" 
  color="{{color}}" 
  setDateTime="{{setDateTime}}" 
  bindconfirm="change"
></tui-datetime>

<!--可输入遮罩层-->
<tui-modal show="{{modal9}}" bind:cancel="hide9" custom="{{true}}" fadein="{{true}}">
  <view bindsubmit="edit_cell" style="text-align: center;">
    <view style="padding-bottom: 20rpx; font-size: 34rpx;">修改</view>
    <form bindsubmit="edit_cell">
      <input name="value" type="{{input_type}}" placeholder="{{edit_old}}" style="margin: 30rpx 40rpx;border-bottom: 1rpx solid #e6e6e6;padding-bottom: 20rpx;font-size: 32rpx;" value="{{edit_old}}"/>
      <button form-type="submit" bindtap="hide9" bind:click="hide9" style="width:75%" class="btn-primary" hover-class="btn-hover" type="small">提交</button>
    </form>
  </view>
</tui-modal>

<!--选择审批结果模态框-->
<tui-modal show="{{showSelectModal}}" bind:cancel="cancelSelect" custom="{{true}}" fadein="{{true}}">
  <view style="text-align: center;">
    <view style="padding-bottom: 20rpx; font-size: 34rpx;">选择审批结果</view>
    <picker range="{{selectOptions}}" value="{{selectOptions.indexOf(selectedValue)}}" bindchange="handleSelectChange">
      <view style="margin: 30rpx 40rpx; padding: 20rpx; border: 1rpx solid #e6e6e6; border-radius: 10rpx;">
        {{selectedValue || '请选择审批结果'}}
      </view>
    </picker>
    <view style="display: flex; justify-content: space-around; margin-top: 30rpx;">
      <button bindtap="cancelSelect" style="width:40%" class="btn-cancel" hover-class="btn-hover" type="small">取消</button>
      <button bindtap="confirmSelect" style="width:40%" class="btn-primary" hover-class="btn-hover" type="small">确定</button>
    </view>
  </view>
</tui-modal>

<!--标题栏-->
<scroll-view scroll-x="true" scroll-y="true" class='scrollClass'>
  <view class='table'>
    <!-- 表头改为7列 -->
    <view class='table_header'>
      <view class="th" style="width: 80rpx;">
        <view class="cell_label_header centerclass">
          <text style="font-weight:bold;">序号</text>
        </view>
      </view>
      <view class="th">
        <view class="cell_label_header centerclass">
          <text style="font-weight:bold;">部门</text>
        </view>
      </view>
      <view class="th">
        <view class="cell_label_header centerclass">
          <text style="font-weight:bold;">姓名</text>
        </view>
      </view>
      <view class="th">
        <view class="cell_label_header centerclass">
          <text style="font-weight:bold;">提交日期</text>
        </view>
      </view>
      <view class="th">
        <view class="cell_label_header centerclass">
          <text style="font-weight:bold;">申请原因</text>
        </view>
      </view>
      <view class="th">
        <view class="cell_label_header centerclass">
          <text style="font-weight:bold;">审批结果</text>
        </view>
      </view>
      <view class="th">
        <view class="cell_label_header centerclass">
          <text style="font-weight:bold;">审批原因</text>
        </view>
      </view>
      <view class="th" style="width: 80rpx;">
        <view class="cell_label_header centerclass">
          <text style="font-weight:bold;">操作</text>
        </view>
      </view>
    </view>

    <!--内容行：绑定所有字段 -->
    <block wx:for="{{list}}" wx:key="id" wx:for-index="idx">
      <view class='table_main'>
        <!-- 序号列 -->
        <view class='td' style='width:80rpx;'>
          <view class="cell_label centerclass">
            {{idx+1}}
          </view>
        </view>
        
        <!-- 部门列 -->
        <view class='td'>
          <view class="cell_label centerclass" 
                bindtap="click_edit" 
                data-id='{{item.id}}' 
                data-type="text" 
                data-x="{{item.bumen || ''}}" 
                data-doinb='bumen'>
            {{item.bumen || ''}}
          </view>
        </view>
        
        <!-- 姓名列 -->
        <view class='td'>
          <view class="cell_label centerclass" 
                bindtap="click_edit" 
                data-id='{{item.id}}' 
                data-type="text" 
                data-x="{{item.xingming || ''}}" 
                data-doinb='xingming'>
            {{item.xingming || ''}}
          </view>
        </view>
        
        <!-- 提交日期列：去掉点击编辑功能，只显示 -->
        <view class='td'>
          <view class="cell_label centerclass">
            {{item.tijiaoriqi || ''}}
          </view>
        </view>
        
        <!-- 申请原因列 -->
        <view class='td'>
          <view class="cell_label centerclass" 
                bindtap="click_edit" 
                data-id='{{item.id}}' 
                data-type="text" 
                data-x="{{item.shenqingyuanyin || ''}}" 
                data-doinb='shenqingyuanyin'>
            {{item.shenqingyuanyin || ''}}
          </view>
        </view>
      
        <!-- 审批结果列 -->
        <view class='td'>
          <view class="cell_label centerclass" 
          style="color:{{item.shenpijieguo === '通过' ? 'white' : (item.shenpijieguo === '驳回' ? 'white' : (item.shenpijieguo === '待审批' ? 'white' : '#333'))}}"
                bindtap="showSelectResult" 
                data-id='{{item.id}}'
                data-field="shenpijieguo"
                data-value="{{item.shenpijieguo || ''}}">
            {{item.shenpijieguo || '点击选择'}}
          </view>
        </view>
        
        <!-- 审批原因列 -->
        <view class='td'>
          <view class="cell_label centerclass" 
                bindtap="click_edit" 
                data-id='{{item.id}}' 
                data-type="text" 
                data-x="{{item.shenpiyuanyin || ''}}" 
                data-doinb='shenpiyuanyin'>
            {{item.shenpiyuanyin || ''}}
          </view>
        </view>
        
        <!-- 操作列：删除按钮 -->
        <view class='td' style='width:80rpx;'>
          <view class="cell_label centerclass" 
                bindtap="click_delete" 
                data-dbid="{{item.id}}" 
                data-id="{{idx+1}}">
            删除
          </view>
        </view>
      </view>
    </block>
  </view>
</scroll-view>

<!--底部操作区-->
<view class="down">
  <view style="display: inline-flex; flex-direction: row;">
    <view style="width:5%"></view>
    <button class="pageButton" hover-class="pageButton-hover" bindtap="lastpage">上一页</button>
    <view style="width:5%"></view>
    <button class="pageButton_page" hover-class="pageButton_page-hover" bindtap="">{{page}}/{{maxpagenumber}} </button>
    <view style="width:5%"></view>
    <button class="pageButton" hover-class="pageButton-hover" bindtap="nextpage">下一页</button>
    <view style="width:5%"></view>
  </view>

  <view style="height:20rpx"></view>

  <view style="display: inline-flex; flex-direction: row;">
    <view style="width:5%"></view>
    <button class="btn-primary" hover-class="btn-hover" bindtap="getExcel">导出Excel</button>
    <view style="width:10%"></view>
    <button class="btn-primary" hover-class="btn-hover" bindtap="showM">添加一行</button>
    <view style="width:5%"></view>
  </view>
</view>